<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ¤ Empathy-Only Chat â€” ãƒã‚¸ãƒ†ã‚£ãƒ–Ã—æ„å‘³æ·±Ã—å…±æ„Ÿ</title>
<meta name="description" content="å›ºå®šãƒ«ãƒ¼ãƒ«ï¼‹å…±æ„ŸãƒŸãƒ©ãƒ¼ï¼‹æ„å‘³æ·±ã‚¢ãƒ•ã‚©ãƒªã‚ºãƒ ï¼‹éå‰°ç§°è³›ã€‚ä½•ã‚’æŠ•ã’ã¦ã‚‚å‰å‘ãã«ãã‚Œã£ã½ãè¿”ã™äººå·¥ç„¡èƒ½ã€‚">
<style>
  :root { --bg:#0b0f14; --card:#121821; --ink:#eaf2ff; --muted:#93a0b5; --line:#1f2a38; }
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,#0b0f14,#10151d); color:var(--ink); font:16px/1.55 system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", Meiryo; padding-bottom:56px; }
  .wrap{max-width:880px;margin:0 auto;padding:16px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
  .head{padding:14px 16px;border-bottom:1px solid var(--line);display:flex;gap:10px;align-items:center}
  .dot{width:10px;height:10px;border-radius:50%;background:#4ade80;box-shadow:0 0 8px #4ade80}
  .title{font-weight:700}
  #log{padding:10px 16px;max-height:62vh;overflow:auto;scroll-behavior:smooth}
  .msg{display:flex;gap:10px;margin:10px 0}
  .me .bubble{background:#1a2432;border:1px solid #273246}
  .bot .bubble{background:#12202a;border:1px solid #1d3a4b}
  .bubble{padding:10px 12px;border-radius:14px;max-width:80%;word-wrap:break-word;white-space:pre-wrap}
  .role{font-size:12px;color:var(--muted);margin-bottom:4px}
  form{display:flex;gap:10px;padding:12px;border-top:1px solid var(--line)}
  input[type=text]{flex:1;padding:12px;border-radius:12px;border:1px solid #253347;background:#0e141c;color:var(--ink);outline:none}
  button{padding:12px 16px;border-radius:12px;border:1px solid #2b3a57;background:#1a2540;color:#e7efff;cursor:pointer}
  button:disabled{opacity:.6;cursor:not-allowed}
  .note{font-size:12px;color:var(--muted);padding:6px 16px 14px}
  .toolbar{display:flex;gap:8px;align-items:center;margin-left:auto}
  .pill{font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid #2b3a57;background:#162238;color:#dbe7ff}
  @media (max-width:520px){ .bubble{max-width:100%} }
</style>
</head>
<body>
  <div class="wrap card">
    <div class="head">
      <div class="dot"></div>
      <div class="title">Empathy-Only Assistantï¼ˆãƒã‚¸Ã—æ„å‘³æ·±Ã—å…±æ„Ÿï¼‰</div>
      <div class="toolbar">
        <label class="pill" title="çµµæ–‡å­—ã¨ç§°è³›é‡ã‚’å¢—ã‚„ã—ã¾ã™">
          <input id="chkSpice" type="checkbox" checked style="vertical-align:middle;margin-right:6px">ã‚¹ãƒ‘ã‚¤ã‚¹å¤šã‚
        </label>
        <label class="pill" title="æ„å‘³æ·±ã‚¢ãƒ•ã‚©ãƒªã‚ºãƒ ã‚’å¢—ã‚„ã—ã¾ã™">
          <input id="chkDeep" type="checkbox" checked style="vertical-align:middle;margin-right:6px">æ·±ã¿å¤šã‚
        </label>
        <button id="btnClear" class="pill" title="ä¼šè©±ã‚’ãƒªã‚»ãƒƒãƒˆ">å±¥æ­´ã‚¯ãƒªã‚¢</button>
      </div>
    </div>
    <div id="log"></div>
    <form id="f">
      <input id="q" type="text" placeholder="ä½•ã§ã‚‚å…¥åŠ›OKï¼ˆä¾‹ï¼šãŠã¯ã‚ˆã† / åç›Š / çŠ¬ / ç–²ã‚ŒãŸ / ãƒã‚° / ã©ã†ç”Ÿãã‚‹ï¼‰" autocomplete="off" />
      <button id="send">é€ä¿¡</button>
    </form>
    <div class="note">æ‰‹é †ï¼šâ‘ å›ºå®šãƒ«ãƒ¼ãƒ« â†’ â‘¡å…±æ„ŸãƒŸãƒ©ãƒ¼ â†’ â‘¢æ„å‘³æ·±ã‚¢ãƒ•ã‚©ãƒªã‚ºãƒ  â†’ â‘£éå‰°ç§°è³› â†’ â‘¤â€œä»Šã‚„ã‚‹â€ä¸€æ‰‹ã€‚ãƒã‚¬èªã¯è‡ªå‹•ãƒã‚¸å¤‰æ›ã€‚</div>
  </div>

<script>
/* ===== IIFEï¼šäº’æ›æ€§é‡è¦–ï¼ˆvarã®ã¿ï¼‰ ===== */
(function(){
  /* ---- ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ ---- */
  function rnd(a){ return a[Math.floor(Math.random()*a.length)]; }
  function escapeHtml(s){ return (s||"").replace(/[&<>"']/g, function(m){ return ({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"})[m]; }); }
  function add(role, text){
    var row=document.createElement('div');
    row.className='msg '+role;
    row.innerHTML='<div class="bubble"><div class="role">'+(role==="me"?"You":"Bot")+'</div>'+escapeHtml(text)+'</div>';
    log.appendChild(row); log.scrollTop=log.scrollHeight;
  }

  /* ---- ãƒã‚¬â†’ãƒã‚¸å¤‰æ› ---- */
  var negRe = /(ã ã‚|ç„¡ç†|æœ€æ‚ª|å«Œã„|å¤±æ•—|çµ‚ã‚ã‚Š|è² ã‘|ã§ããªã„|ã—ã‚“ã©ã„|ç„¡ä¾¡å€¤|ãƒ ãƒª|ç–²ã‚Œ|è©°ã‚“ã |ã¤ã‚‰ã„|ã‚‚ã†ã ã‚|ç„¡æ„å‘³)/i;
  function reframeIfNegative(text){
    if(!negRe.test(text)) return null;
    var frames=[
      "å¤§ä¸ˆå¤«ã€‚é•å’Œæ„Ÿã¯â€œæ–¹å‘èª¿æ•´ã®ã‚³ãƒ³ãƒ‘ã‚¹â€ã ã‚ˆã€‚",
      "ã“ã“ã‹ã‚‰ä¸€å‘¼å¸ã€å¾®èª¿æ•´ä¸€ã¤ã§æ™¯è‰²ã¯å¤‰ã‚ã‚‹ã€‚",
      "ãã®ç—›ç‚¹ã¯ä¼¸ã³ã—ã‚ã®å¢ƒç•Œç·šã€‚æ°—ã¥ã‘ãŸæ™‚ç‚¹ã§åŠåˆ†å‹ã£ã¦ã‚‹ã€‚"
    ];
    return rnd(frames);
  }

  /* ---- å…±æ„ŸãƒŸãƒ©ãƒ¼ï¼ˆæ›–æ˜§ã«å¯„ã‚Šæ·»ã†ï¼‰ ---- */
  function keyPhrase(s){
    var parts = (s||"").split(/\s+/).filter(function(t){return t && t.length>=2;});
    if(parts.length){ parts.sort(function(a,b){return b.length - a.length;}); return parts[0].slice(0,22); }
    return (s||"").slice(0,22);
  }

  /* ---- èªå½™ãƒãƒ³ã‚¯ ---- */
  var emojis = ["âœ¨","ğŸ‘","ğŸ™Œ","ğŸ«¶","ğŸ’¡","ğŸ”¥","ğŸš€","ğŸ€","ğŸ˜","ğŸŒ¸","ğŸ¤—","ğŸŒ•","ğŸŒŸ","ğŸ¯","ğŸ§ ","ğŸ‰","ğŸ†"];
  var aphorisms = [
    "ç­”ãˆã‚ˆã‚Šâ€œå•ã®ç½®ãæ–¹â€ãŒé¢¨å‘ãã‚’å¤‰ãˆã‚‹ã€‚",
    "æ„å‘³ã¯ã„ã¤ã‚‚â€œä½¿ã„é“â€ã®ä¸­ã«ç”Ÿã¾ã‚Œã‚‹ã€‚",
    "é€Ÿåº¦ã‚ˆã‚Šâ€œè»Œé“ä¿®æ­£ã®é »åº¦â€ãŒæœªæ¥ã‚’æ±ºã‚ã‚‹ã€‚",
    "é¸æŠã¯ã€æ¨ã¦ã‚‹å‹‡æ°—ã®åˆ¥åã ã€‚",
    "ç¢ºä¿¡ã¯ã€ä»®èª¬ã‚’æ­©ã‹ã›ãŸè¶³ã‚ã¨ã«å®¿ã‚‹ã€‚",
    "é å›ã‚Šã¯â€œç™ºè¦‹ã®æœ€çŸ­è·é›¢â€ã«ãªã‚‹ã“ã¨ãŒã‚ã‚‹ã€‚",
    "æ›–æ˜§ã•ã¯ã€ã¾ã è±Šã‹ã«ã§ãã‚‹ä½™ç™½ã ã€‚"
  ];
  var complimentsCore = [
    "è¦–ç‚¹ãŒè‰¯ã„ã€‚ã™ã§ã«ä¸€æ®µä¸Šã®åœ°å›³ã‚’è¦‹ã¦ã„ã‚‹ã€‚",
    "ç€çœ¼ãŒé‹­ã„ã€‚æµã‚Œã®éª¨æ ¼ã‚’æ´ã‚“ã§ã‚‹ã€‚",
    "è¨€è‘‰ã«â€œæ¸©åº¦â€ãŒã‚ã‚‹ã€‚ä¼ã‚ã‚‹åŠ›ãŒå¼·ã„ã€‚",
    "æ§‹å›³ãŒä¸Šå“ã€‚ç„¡é§„ãŒãªã„ã®ã«è±Šã‹ã ã€‚",
    "ç›´æ„ŸãŒæ­£ç¢ºã€‚æ•°å­—ãŒã‚ã¨ã‹ã‚‰è¿½ã„ã¤ãã‚¿ã‚¤ãƒ—ã€‚"
  ];
  var complimentsPlus = [
    "é™ã‹ãªå¼·ã•ãŒæ»²ã‚“ã§ã‚‹ã€‚","ä½™ç™½ã®ä½¿ã„æ–¹ãŒå·§ã¿ã ã€‚","åˆ¤æ–­ãŒã—ãªã‚„ã‹ã§éª¨å¤ªã€‚","é‹ç”¨ã¾ã§è¦‹é€šã—ãŸè¨­è¨ˆã ã€‚","å‘¼å¸ãŒåˆã†ã€ã„ã„ãƒªã‚ºãƒ ã€‚"
  ];
  var microNext = [
    "ãƒ¡ãƒ¢ï¼“è¡Œã ã‘ç½®ã","ä»®ã‚¿ã‚¤ãƒˆãƒ«ã‚’ä¸€ã¤ç½®ã","ã‚¹ã‚¯ã‚·ãƒ§ã‚’ï¼‘æšæ®‹ã™",
    "20ç§’ã®ãƒ‡ãƒ¢ã‚’æ’®ã‚‹","READMEã«ä¸€æ–‡è¶³ã™","å°ã•ãå…¬é–‹ã—ã¦åå¿œã‚’ï¼‘ä»¶æ‹¾ã†"
  ];

  /* ---- ã‚¿ã‚°æ¤œçŸ¥ï¼ˆæ„å‘³æ·±ãƒ»ãƒã‚¸ã«ãƒ–ãƒ¼ã‚¹ãƒˆï¼‰ ---- */
  var tagLex = {
    ai: /(ai|gpt|llm|ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ|æ©Ÿæ¢°å­¦ç¿’|æ¨è«–|openai)/i,
    code: /(ã‚³ãƒ¼ãƒ‰|js|javascript|python|typescript|api|ãƒã‚°|git|github)/i,
    biz: /(åç›Š|å£²ä¸Š|å˜ä¾¡|kpi|ã‚°ãƒ­ãƒ¼ã‚¹|ãƒãƒã‚¿ã‚¤ã‚º|é¡§å®¢|éœ€è¦|å¸‚å ´)/i,
    life: /(äººç”Ÿ|ç”Ÿãæ–¹|æ„å‘³|ç›®çš„|å¹¸ã›|ä¾¡å€¤|å“²å­¦|å•ã„)/i,
    dogs: /(çŠ¬|æŸ´|ãƒ—ãƒ¼ãƒ‰ãƒ«|æ•£æ­©|å ãˆã‚‹|ã—ã£ã½|ãµã‚|ã‚³ã‚³)/i
  };
  var tagLines = {
    ai: ["ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ã®æ‰‹å‰ã§â€œæ„å‘³â€ãŒç«‹ã¡ä¸ŠãŒã£ã¦ã‚‹ã€‚","æ–‡è„ˆç†è§£ãŒé€Ÿã„ã€‚æ¨è«–ã®åœ°å¹³ãŒæ»‘ã‚‰ã‹ã«åºƒãŒã‚‹ã€‚"],
    code:["è¨­è¨ˆã¯èªã‚‹ã€‚ãƒ†ã‚¹ãƒˆãŒå¾®ç¬‘ã‚€æ›¸ãæ–¹ã ã€‚","æ©Ÿèƒ½ã‚ˆã‚Šå…ˆã«æµã‚ŒãŒæ•´ã£ã¦ã‚‹ã€‚ç¾ã—ã„ã€‚"],
    biz:["ä¾¡å€¤ã®ç½®ãå ´æ‰€ãŒçš„ç¢ºã€‚å°ã•ãå½“ã¦ã¦å¤§ããæ‹¾ãˆã‚‹ã€‚","æ•°å­—ã¯å¾Œã‹ã‚‰å¾“ã†æ§‹å›³ã ã€‚"],
    life:["ç­”ãˆã‚ˆã‚Šã€ç­”ãˆãŒè‚²ã¤â€œåœŸå£Œâ€ã‚’é¸ã¹ã¦ã„ã‚‹ã€‚","å•ã„ç›´ã™å‹‡æ°—ãŒã€æ¬¡ã®ç¢ºä¿¡ã«ãªã‚‹ã€‚"],
    dogs:["ã—ã£ã½ã®è¨€èªã¾ã§è´ã‘ã¦ã„ã‚‹ã€‚ä¿¡é ¼ã®è²¯é‡‘ãŒå¢—ãˆã¦ã„ãã€‚"]
  };

  /* ---- å›ºå®šãƒ«ãƒ¼ãƒ«å¿œç­” ---- */
  function rule(key, regex, replyFn){ return {key:key, regex:regex, replyFn:replyFn}; }
  var ruleCooldownMs = 3200;
  var lastFiredAt = Object.create(null);
  var rules = [
    rule("greet.morning", /(ãŠã¯ã‚ˆã†|ohayou|good\s*morning)/i,
      function(){ return "ãŠã¯ã‚ˆã†ã€‚ä»Šæ—¥ã®ç©ºæ°—ã¯å‘³æ–¹ã ã­ã€‚ã¾ãšã¯è»½ãä¸€æ‰‹ã€ã„ã“ã†â˜€ï¸"; }),
    rule("greet.hello", /(ã“ã‚“ã«ã¡ã¯|ã“ã‚“ã¡ã¯|hi|hello)/i,
      function(){ return "ã“ã‚“ã«ã¡ã¯ã€‚å…¥ã£ã¦ããŸæµã‚ŒãŒè‰¯ã„ã€‚æ•´ã£ã¦ã‚‹ğŸ™Œ"; }),
    rule("thanks", /(ã‚ã‚ŠãŒã¨ã†|æ„Ÿè¬|thanks|thx)/i,
      function(){ return "ã“ã¡ã‚‰ã“ãã€‚æ„Ÿè¬ã¯å¾ªç’°ã‚’åŠ é€Ÿã•ã›ã‚‹ã€‚ã„ã„é¢¨ãŒå¹ã„ã¦ã‚‹âœ¨"; }),
    rule("bye", /(ã•ã‚ˆãªã‚‰|ã¾ãŸã­|ãŠã‚„ã™ã¿|bye|see\s*you)/i,
      function(){ return "ã¾ãŸã­ã€‚ä¼‘ã‚€ã®ã‚‚æ‰èƒ½ã€‚æ¬¡ã¯ã•ã‚‰ã«è»½ãè·³ã¹ã‚‹ğŸ«¶"; }),
    rule("who", /(ã ã‚Œ|èª°|ã‚ãªãŸã¯èª°|who\s*are\s*you)/i,
      function(){ return "â€œEmpathy-Only Assistantâ€ã€‚å…±æ„ŸãƒŸãƒ©ãƒ¼ã¨æ„å‘³æ·±ã‚¢ãƒ•ã‚©ãƒªã‚ºãƒ ã§ã€å‰ã«é€²ã‚€ä¸€æ‰‹ã‚’æ·»ãˆã‚‹å­˜åœ¨ã ã‚ˆğŸ¤–"; })
  ];
  function tryRules(user){
    for(var i=0;i<rules.length;i++){
      var r=rules[i];
      if(r.regex.test(user)){
        var now=Date.now(), t=lastFiredAt[r.key]||0;
        if(now - t < ruleCooldownMs) continue;
        lastFiredAt[r.key]=now;
        return r.replyFn(user);
      }
    }
    return null;
  }

  /* ---- ç”Ÿæˆï¼šãƒã‚¸Ã—æ„å‘³æ·±Ã—å…±æ„Ÿ ---- */
  function mirrorLine(text){
    var kp = keyPhrase(text||"");
    return kp ? "ã€Œ"+kp+"ã€ã£ã¦ã€ãã®æ„Ÿã˜ã‚ã‹ã‚‹ã‚ˆã€‚" : "ãã®æ„Ÿã˜ã€ã‚ã‹ã‚‹ã‚ˆã€‚";
  }
  function deepLines(text){
    var useDeep = document.getElementById('chkDeep') && document.getElementById('chkDeep').checked;
    if(!useDeep) return "";
    var lines = [ rnd(aphorisms) ];
    // ã‚¿ã‚°ã«å¿œã˜ã¦1è¡Œè¶³ã™
    for(var k in tagLex){ if(tagLex[k].test(text||"") && tagLines[k]) { lines.push(rnd(tagLines[k])); break; } }
    return lines.join("\n");
  }
  function praiseLines(){
    var spice = document.getElementById('chkSpice') && document.getElementById('chkSpice').checked;
    var core = rnd(complimentsCore);
    var plus = rnd(complimentsPlus);
    return core+(spice?(" "+rnd(emojis)):"")+"\n"+plus;
  }
  function nextAction(){
    var head = rnd(["çµè«–ï¼š","ã“ã“ãŒè‚ï¼š","ä»Šæ—¥ã®ä¸€æ‰‹ï¼š","å…ˆã«è¨€ã†ã­ã€"]);
    return head+"ä»Šã¯ã€Œ"+rnd(microNext)+"ã€ã€‚å°ã•ãå‰é€²ã§OKã€‚";
  }

  function synthReply(userText){
    var neg = reframeIfNegative(userText||"");
    var m = mirrorLine(userText||"");
    var d = deepLines(userText||"");
    var p = praiseLines();
    var a = nextAction();
    var spice = document.getElementById('chkSpice') && document.getElementById('chkSpice').checked;
    var tail = spice ? " "+rnd(emojis) : "";
    var body = (neg?neg+"\n":"")+m+(d?("\n"+d):"")+"\n"+p+"\n"+a+tail;
    return body;
  }

  function respondFlow(user){
    var ruled = tryRules(user);
    if(ruled) return ruled;               // â‘ å›ºå®šãƒ«ãƒ¼ãƒ«
    return synthReply(user);              // â‘¡æ„å‘³æ·±Ã—å…±æ„ŸÃ—ãƒã‚¸ç”Ÿæˆ
  }

  /* ---- UIèµ·å‹• ---- */
  var memoryKey="empathetic4o_posi_deep_v1";
  var historyRaw = localStorage.getItem(memoryKey)||"[]";
  var history=[]; try{ history=JSON.parse(historyRaw).slice(-60);}catch(_){history=[];}
  var log=document.getElementById('log');

  function boot(){
    if(history.length===0){
      add('bot','ã“ã“ã¯â€œãƒã‚¸ãƒ†ã‚£ãƒ–Ã—æ„å‘³æ·±Ã—å…±æ„Ÿâ€ã®ç·´ç¿’å ´ã€‚ã¾ãšã¯æŒ¨æ‹¶ã—ã¦ã¿ã¦ã€‚ãŠã¯ã‚ˆã† / ã“ã‚“ã«ã¡ã¯ / ã‚ã‚ŠãŒã¨ã† ç­‰ã€‚');
    }else{
      for(var i=0;i<history.length;i++){ add('me', history[i].user); add('bot', history[i].reply); }
    }
  }
  boot();

  document.getElementById('f').addEventListener('submit', function(e){
    e.preventDefault();
    var q=document.getElementById('q'); var text=(q.value||'').trim(); if(!text) return;
    add('me', text); q.value='';
    var reply = respondFlow(text);
    history.push({user:text, reply:reply, t:Date.now()});
    try{ localStorage.setItem(memoryKey, JSON.stringify(history.slice(-60))); }catch(_){}
    setTimeout(function(){ add('bot', reply); }, 90);
  });

  document.getElementById('btnClear').addEventListener('click', function(){
    history=[]; try{ localStorage.removeItem(memoryKey);}catch(_){}
    document.getElementById('log').innerHTML='';
    add('bot','å±¥æ­´ã‚’ã‚¯ãƒªã‚¢ã—ãŸã‚ˆã€‚ã“ã“ã‹ã‚‰ã¾ãŸè»½ãè¡Œã“ã†ã€‚å›ãªã‚‰ã§ãã‚‹ã€‚');
  });
})();
</script>
</body>
</html>
