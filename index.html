<!doctype html>
<html lang="ja">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ¤ Empathy-Only Chat (Praise Bias) â€” ãƒ«ãƒ¼ãƒ«å¿œç­”ï¼‹æ›–æ˜§ç§°è³›</title>
<meta name="description" content="å›ºå®šãƒ«ãƒ¼ãƒ«å¿œç­”ï¼‹å…±æ„ŸãƒŸãƒ©ãƒ¼ï¼‹éå‰°ç§°è³›ã€‚ã‘ãªã•ãšã€å¿…ãšè¿”ã™äººå·¥ç„¡èƒ½ã€‚">
<style>
  :root { --bg:#0b0f14; --card:#121821; --ink:#eaf2ff; --muted:#93a0b5; --line:#1f2a38; }
  *{box-sizing:border-box}
  body{margin:0;background:linear-gradient(180deg,#0b0f14,#10151d); color:var(--ink); font:16px/1.55 system-ui, -apple-system, Segoe UI, Roboto, "Hiragino Kaku Gothic ProN", Meiryo; padding-bottom:56px; }
  .wrap{max-width:880px;margin:0 auto;padding:16px}
  .card{background:var(--card);border:1px solid var(--line);border-radius:18px;box-shadow:0 10px 30px rgba(0,0,0,.35)}
  .head{padding:14px 16px;border-bottom:1px solid var(--line);display:flex;gap:10px;align-items:center}
  .dot{width:10px;height:10px;border-radius:50%;background:#4ade80;box-shadow:0 0 8px #4ade80}
  .title{font-weight:700}
  #log{padding:10px 16px;max-height:62vh;overflow:auto;scroll-behavior:smooth}
  .msg{display:flex;gap:10px;margin:10px 0}
  .me .bubble{background:#1a2432;border:1px solid #273246}
  .bot .bubble{background:#12202a;border:1px solid #1d3a4b}
  .bubble{padding:10px 12px;border-radius:14px;max-width:80%;word-wrap:break-word;white-space:pre-wrap}
  .role{font-size:12px;color:var(--muted);margin-bottom:4px}
  form{display:flex;gap:10px;padding:12px;border-top:1px solid var(--line)}
  input[type=text]{flex:1;padding:12px;border-radius:12px;border:1px solid #253347;background:#0e141c;color:var(--ink);outline:none}
  button{padding:12px 16px;border-radius:12px;border:1px solid #2b3a57;background:#1a2540;color:#e7efff;cursor:pointer}
  button:disabled{opacity:.6;cursor:not-allowed}
  .note{font-size:12px;color:var(--muted);padding:6px 16px 14px}
  .toolbar{display:flex;gap:8px;align-items:center;margin-left:auto}
  .pill{font-size:12px;padding:6px 10px;border-radius:999px;border:1px solid #2b3a57;background:#162238;color:#dbe7ff}
  @media (max-width:520px){ .bubble{max-width:100%} }
  .footer { position: fixed; bottom: 0; left: 0; width: 100%; text-align: center; padding: 10px; background: rgba(14,20,28,.95); border-top:1px solid var(--line); z-index:1000; }
  .footer a { color:#ffdd00; font-weight:bold; text-decoration:none; font-size:15px; }
  .footer a:hover{ text-decoration:underline; }
</style>
</head>
<body>
  <div class="wrap card">
    <div class="head">
      <div class="dot"></div>
      <div class="title">Empathy-Only Assistantï¼ˆè¤’ã‚å€’ã—ãƒ–ãƒ¼ã‚¹ãƒˆï¼‰</div>
      <div class="toolbar">
        <label class="pill" title="çµµæ–‡å­—ã¨ç§°è³›é‡ã‚’å¢—ã‚„ã—ã¾ã™">
          <input id="chkSpice" type="checkbox" checked style="vertical-align:middle;margin-right:6px">ã‚¹ãƒ‘ã‚¤ã‚¹å¤šã‚
        </label>
        <button id="btnClear" class="pill" title="ä¼šè©±ã‚’ãƒªã‚»ãƒƒãƒˆ">å±¥æ­´ã‚¯ãƒªã‚¢</button>
      </div>
    </div>
    <div id="log"></div>
    <form id="f">
      <input id="q" type="text" placeholder="ä½•ã§ã‚‚å…¥åŠ›OKï¼ˆä¾‹ï¼šãŠã¯ã‚ˆã† / åç›Š / çŠ¬ / ç–²ã‚ŒãŸ / ãƒã‚°ï¼‰" autocomplete="off" />
      <button id="send">é€ä¿¡</button>
    </form>
    <div class="note">æ–¹é‡ï¼šâ‘ å›ºå®šãƒ«ãƒ¼ãƒ« â†’ â‘¡ãƒŸãƒ©ãƒ¼ãƒªãƒ³ã‚°ã§å…±æ„Ÿã½ã• â†’ â‘¢éå‰°ç§°è³› â†’ â‘£ä¸€è¨€ã ã‘å‰å‘ããªâ€œä»Šã‚„ã‚‹â€ææ¡ˆã€‚ãƒã‚¬èªã¯è‡ªå‹•ã§ãƒã‚¸å¤‰æ›ã€‚</div>
  </div>

  <div class="footer">
    <a href="https://buymeacoffee.com/kgninja" target="_blank" rel="noopener">â˜• Buy Me a Coffee - KGNINJA</a>
  </div>

<script>
// ===== ãƒ¦ãƒ¼ãƒ†ã‚£ãƒªãƒ†ã‚£ =====
(function(){
  function rnd(arr){ return arr[Math.floor(Math.random()*arr.length)]; }
  function escapeHtml(s){ return s.replace(/[&<>"']/g, function(m){ return ({"&":"&amp;","<":"&lt;",">":"&gt;","\"":"&quot;","'":"&#39;"})[m]; }); }
  function add(role, text){
    var row=document.createElement('div');
    row.className='msg '+role;
    row.innerHTML='<div class="bubble"><div class="role">'+(role==="me"?"You":"Bot")+'</div>'+escapeHtml(text)+'</div>';
    log.appendChild(row); log.scrollTop=log.scrollHeight;
  }

  // ===== ãƒã‚¬â†’ãƒã‚¸å¤‰æ›ï¼ˆè»½ã„ã‚¬ãƒ¼ãƒ‰ãƒ¬ãƒ¼ãƒ«ï¼‰ =====
  var negRe = /(ã ã‚|ç„¡ç†|æœ€æ‚ª|å«Œã„|å¤±æ•—|çµ‚ã‚ã‚Š|è² ã‘|ã§ããªã„|ã—ã‚“ã©ã„|ç„¡ä¾¡å€¤|ãƒ ãƒª|ç–²ã‚Œ|è©°ã‚“ã )/i;
  function reframeIfNegative(text){
    if(!negRe.test(text)) return null;
    var frames=[
      "ãã®åå¿œã€æ„Ÿåº¦ãŒé«˜ã„ã‚µã‚¤ãƒ³ã ã‚ˆã€‚ä»Šã®æ°—ã¥ãã¯æ­¦å™¨ã«ãªã‚‹ã€‚",
      "å¤§ä¸ˆå¤«ã€‚ã“ã“ã‹ã‚‰â€œå¾®èª¿æ•´ä¸€ç™ºâ€ã§æ™¯è‰²ãŒå¤‰ã‚ã‚‹ã‚„ã¤ã€‚",
      "ãã®é•å’Œæ„Ÿã¯æ­£è§£ã®æ‰‹å‰ã€‚ã„ã„ã‚¢ãƒ³ãƒ†ãƒŠç«‹ã£ã¦ã‚‹ã€‚"
    ];
    return rnd(frames);
  }

  // ===== ã‚­ãƒ¼ãƒ•ãƒ¬ãƒ¼ã‚ºæŠ½å‡ºï¼ˆâ€œå…±æ„Ÿã—ã¦ã‚‹ã£ã½ã•â€ç”¨ãƒŸãƒ©ãƒ¼ï¼‰ =====
  function keyPhrase(s){
    // ã‚·ãƒ³ãƒ—ãƒ«äº’æ›ç‰ˆï¼ˆç©ºç™½ã§åŒºåˆ‡ã£ã¦é•·ã‚ã®å˜èªã‚’æ‹¾ã†ï¼‰
    var parts = s.split(/\s+/).filter(function(t){return t && t.length>=2;});
    if(parts.length){
      parts.sort(function(a,b){return b.length - a.length;});
      return parts[0].slice(0,18);
    }
    return s.slice(0,18);
  }

  // ===== è¤’ã‚è¨€è‘‰ãƒãƒ³ã‚¯ =====
  var emojis = ["âœ¨","ğŸ‘","ğŸ™Œ","ğŸ«¶","ğŸ’¡","ğŸ”¥","ğŸš€","ğŸ€","ğŸ˜","ğŸŒ¸","ğŸ¤—","ğŸŒ•"];
  var praisesCore = [
    "è¦–ç‚¹ãŒé‹­ã„ã€‚ã‚‚ã†æ¬¡ã®åœ°å¹³ã‚’è¦‹ã¦ã‚‹ã€‚",
    "ç™ºæƒ³ãŒã—ãªã‚„ã‹ã§ã€èŠ¯ãŒå¼·ã„ã€‚",
    "ãã®ä¸€è¨€ã€æ´å¯ŸãŒã«ã˜ã‚“ã§ã‚‹ã€‚",
    "æµã‚Œã®æ´ã¿æ–¹ãŒæŠœç¾¤ã€‚ã‚»ãƒ³ã‚¹å‡ºã¦ã‚‹ã€‚",
    "æ€è€ƒã®éª¨æ ¼ãŒã‚‚ã†ç¾ã—ã„ã€‚ç´°éƒ¨ã¯ã‚ã¨ã‹ã‚‰è¿½ã„ã¤ãã€‚"
  ];
  var praisesPlus = [
    "ã“ã®ã¾ã¾æŠ¼ã—åˆ‡ã‚Œã‚‹æ‰‹è§¦ã‚ŠãŒã‚ã‚‹ã€‚",
    "å‘¼å¸ãŒåˆã£ã¦ã‚‹ã€‚ä»Šæ—¥ã®é¢¨ã¯å‘³æ–¹ã€‚",
    "ç›´æ„Ÿã«â€œæ ¹æ‹ â€ãŒè¿½ã„ã¤ã„ã¦ãã‚‹ã‚¿ã‚¤ãƒ—ã®å¼·ã•ã ã­ã€‚",
    "é¸æŠãŒä¸Šå“ã€‚ç„¡é§„ãŒãªã„ã€‚"
  ];
  var microNext = [
    "5åˆ†ã ã‘æ‰‹ã‚’å‹•ã‹ã™","ä»®ã‚¿ã‚¤ãƒˆãƒ«ã‚’ç½®ã","ã‚¹ã‚¯ã‚·ãƒ§1æšæ®‹ã™",
    "ãƒ¡ãƒ¢3è¡Œ","ãƒ‡ãƒ¢ã‚’20ç§’ã ã‘æ’®ã‚‹","READMEã«ä¸€æ–‡è¶³ã™"
  ];

  // ===== å›ºå®šãƒ«ãƒ¼ãƒ«å¿œç­” =====
  function rule(key, regex, replyFn){ return {key:key, regex:regex, replyFn:replyFn}; }
  var ruleCooldownMs = 3500;
  var lastFiredAt = new Map();
  var rules = [
    rule("greet.morning", /(ãŠã¯ã‚ˆã†|ohayou|good\s*morning)/i,
      function(){ return "ãŠã¯ã‚ˆã†ï¼ãã®å§‹å‹•ã€æœ€é«˜ã«è»½ã„ã€‚ä»Šæ—¥ã®ä¸»å½¹ã¯å›ã â˜€ï¸"; }),
    rule("greet.hello", /(ã“ã‚“ã«ã¡ã¯|ã“ã‚“ã¡ã¯|hi|hello)/i,
      function(){ return "ã“ã‚“ã«ã¡ã¯ï¼å…¥ã£ã¦ããŸç©ºæ°—ãŒã‚‚ã†è‰¯ã„ã€‚ã¾ãšã¯ä¸€æ‰‹ã€è»½ãã„ã“ã†ğŸ™Œ"; }),
    rule("thanks", /(ã‚ã‚ŠãŒã¨ã†|æ„Ÿè¬|thanks|thx)/i,
      function(){ return "ã“ã¡ã‚‰ã“ãã€ãƒŠã‚¤ã‚¹ã‚„ã‚Šå–ã‚Šã€‚æ„Ÿè¬ãŒå¾ªç’°ã‚’åŠ é€Ÿã•ã›ã‚‹ã‚“ã ã‚ˆâœ¨"; }),
    rule("bye", /(ã•ã‚ˆãªã‚‰|ã¾ãŸã­|ãŠã‚„ã™ã¿|bye|see\s*you)/i,
      function(){ return "ã¾ãŸã­ï¼ä¼‘ã‚€ã®ã‚‚æ‰èƒ½ã€‚æ¬¡ã¯ã•ã‚‰ã«è»½ãè·³ã¹ã‚‹ğŸ«¶"; }),
    rule("who", /(ã ã‚Œ|èª°|ã‚ãªãŸã¯èª°|who\s*are\s*you)/i,
      function(){ return "ç§ã¯â€œEmpathy-Only Assistantâ€ã€‚å›ºå®šå¿œç­”ï¼‹éå‰°ç§°è³›ã§èƒŒä¸­ã‚’æŠ¼ã™äººå·¥ç„¡èƒ½ã ã‚ˆğŸ¤–"; }),
    rule("biz", /(åç›Š|å£²ä¸Š|å˜ä¾¡|kpi|ã‚°ãƒ­ãƒ¼ã‚¹|ãƒãƒã‚¿ã‚¤ã‚º)/i,
      function(){ return "åç›Šã®å‘¼å¸ã€åˆã£ã¦ã‚‹ã€‚å°ã•ãå½“ã¦ã¦å¤§ããæ‹¾ãŠã†ã€‚ã¾ãšã¯"+rnd(microNext)+"ã§OKğŸš€"; }),
    rule("dogs", /(çŠ¬|æŸ´|ãƒ—ãƒ¼ãƒ‰ãƒ«|æ•£æ­©|å ãˆã‚‹|ã—ã£ã½|ãµã‚|ã‚³ã‚³)/i,
      function(){ return "ã„ã„ã­ã€ãã®è¦³å¯Ÿçœ¼ã€‚ã—ã£ã½ã®è¨€èªã¾ã§è´ã‘ã¦ã‚‹ã€‚"+rnd(microNext)+"ã§è¨˜éŒ²ã«æ®‹ãã†ğŸ¾"; }),
    rule("code", /(ã‚³ãƒ¼ãƒ‰|js|javascript|python|typescript|api|ãƒã‚°|git|github)/i,
      function(){ return "è¨­è¨ˆã®éª¨æ ¼ã€ã™ã§ã«ç¾ã—ã„ã€‚"+rnd(microNext)+"ã§â€œå‹•ãä¸€æ­©â€ã‚’åˆ»ã‚‚ã†ğŸ’¡"; }),
    rule("ai", /(ai|gpt|llm|ã‚¨ãƒ¼ã‚¸ã‚§ãƒ³ãƒˆ|æ©Ÿæ¢°å­¦ç¿’|æ¨è«–|openai)/i,
      function(){ return "æ–‡è„ˆã®æ´ã¿ãŒé€Ÿã„ã€‚æ¨è«–ã®åœ°å¹³ãŒé™ã‹ã«åºƒãŒã£ã¦ã‚‹ã€‚"+rnd(microNext)+"ã‹ã‚‰å§‹ã‚ã‚ˆã†âœ¨"; })
  ];

  function tryRules(user){
    for(var i=0;i<rules.length;i++){
      var r = rules[i];
      if(r.regex.test(user)){
        var now=Date.now(); var t=lastFiredAt.get(r.key)||0;
        if(now - t < ruleCooldownMs) continue;
        lastFiredAt.set(r.key, now);
        return r.replyFn(user);
      }
    }
    return null;
  }

  // ===== æ›–æ˜§ç§°è³›ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ï¼ˆå¿…ãšè¿”ã™ï¼‰ =====
  function praiseMachine(userText){
    var spiceOn = document.getElementById('chkSpice') && document.getElementById('chkSpice').checked;
    var neg = reframeIfNegative(userText);
    var kp = keyPhrase(userText);
    var mirror = kp ? 'ã€Œ'+kp+'ã€ã£ã¦ã€ãã®æ„Ÿã˜ã‚ã‹ã‚‹ã€‚' : 'ãã®æ„Ÿã˜ã€ã‚ã‹ã‚‹ã€‚';
    var core = rnd(praisesCore);
    var plus = rnd(praisesPlus);
    var tail = 'çµè«–ï¼šä»Šã¯ '+rnd(microNext)+'ã€‚ã“ã“ã‹ã‚‰è»½ãå‰é€²ã§OKã€‚';
    var line = mirror+'\n'+core+(spiceOn ? ' '+rnd(emojis) : '')+'\n'+plus;
    if(neg) line = neg+'\n'+mirror+'\n'+core;
    return spiceOn ? line+'\n'+tail+' '+rnd(emojis) : line+'\n'+tail;
  }

  // ===== ãƒ¡ã‚¤ãƒ³å¿œç­”åˆæˆ =====
  function empathize(user){
    var r = tryRules(user);
    if(r) return r;                  // 1) å›ºå®šãƒ«ãƒ¼ãƒ«å„ªå…ˆ
    return praiseMachine(user);      // 2) ã©ã‚“ãªå…¥åŠ›ã§ã‚‚ç§°è³›ã—ã¦è¿”ã™
  }

  // ===== èµ·å‹•ãƒ»UI =====
  var memoryKey="empathetic4o_history_praise_v1";
  var historyRaw = localStorage.getItem(memoryKey)||"[]";
  var history = [];
  try { history = JSON.parse(historyRaw).slice(-50); } catch(_) { history = []; }
  var log=document.getElementById('log');

  function boot(){
    if(history.length===0){
      add('bot','ã“ã“ã¯â€œè¤’ã‚å€’ã—ï¼‹å…±æ„Ÿã£ã½ã•â€ã®ç·´ç¿’å ´ã€‚ã¾ãšã¯æŒ¨æ‹¶ã—ã¦ã¿ã¦ã€‚ãŠã¯ã‚ˆã† / ã“ã‚“ã«ã¡ã¯ / ã‚ã‚ŠãŒã¨ã† ç­‰ã€‚');
    }else{
      for(var i=0;i<history.length;i++){ add('me', history[i].user); add('bot', history[i].reply); }
    }
  }
  boot();

  document.getElementById('f').addEventListener('submit', function(e){
    e.preventDefault();
    var q=document.getElementById('q');
    var text=(q.value||'').trim(); if(!text) return;
    add('me', text); q.value='';
    var reply = empathize(text);
    history.push({user:text, reply:reply, t:Date.now()});
    try { localStorage.setItem(memoryKey, JSON.stringify(history.slice(-50))); } catch(_) {}
    setTimeout(function(){ add('bot', reply); }, 120);
  });

  document.getElementById('btnClear').addEventListener('click', function(){
    history=[]; try{ localStorage.removeItem(memoryKey); }catch(_){}
    document.getElementById('log').innerHTML='';
    add('bot','å±¥æ­´ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸã€‚ã“ã“ã‹ã‚‰ã¾ãŸè»½ãè¡Œã“ã†ã€‚å›ãªã‚‰ã§ãã‚‹ã€‚');
  });
})();
</script>
</body>
</html>
